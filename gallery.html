<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Photo Gallery</title>
    <link rel="stylesheet" href="styles.css">
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            padding: 40px 20px;
            color: #fff;
        }

        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #667eea;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .welcome-screen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            animation: fadeIn 0.5s ease;
        }

        .welcome-screen.hidden {
            animation: fadeOut 0.8s ease forwards;
            pointer-events: none;
        }

        .welcome-content {
            text-align: center;
            animation: slideUp 1s ease 0.3s backwards;
        }

        .welcome-icon {
            font-size: 5em;
            margin-bottom: 20px;
            animation: bounce 2s ease-in-out infinite;
        }

        .welcome-content h1 {
            font-size: 3.5em;
            margin-bottom: 10px;
            color: #fff;
            text-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            font-weight: 700;
        }

        .welcome-content p {
            font-size: 1.3em;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 40px;
            max-width: 500px;
            line-height: 1.6;
        }

        .welcome-btn {
            background: #fff;
            color: #667eea;
            border: none;
            padding: 15px 50px;
            font-size: 1.1em;
            font-weight: 600;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            animation: slideUp 1s ease 0.6s backwards;
        }

        .welcome-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.3);
        }

        .welcome-btn:active {
            transform: translateY(-1px);
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes bounce {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-20px);
            }
        }

        @keyframes fadeOut {
            to {
                opacity: 0;
            }
        }

        .loading-bar {
            position: fixed;
            top: 0;
            left: 0;
            height: 3px;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            width: 0;
            z-index: 1999;
            transition: width 0.3s ease;
        }

        .loading-counter {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.7);
            color: #667eea;
            padding: 10px 20px;
            border-radius: 50px;
            font-size: 0.9em;
            z-index: 100;
            display: none;
            font-weight: 600;
        }

        .loading-counter.show {
            display: block;
        }

        .header {
            text-align: center;
            margin-bottom: 50px;
            animation: fadeInDown 0.8s ease;
        }

        .header h1 {
            font-size: 3em;
            <script src="app.js" defer></script>
        </div>
    </div>

    <div class="container">
        <div class="loading-bar" id="loadingBar"></div>
        <div class="loading-counter" id="loadingCounter"></div>
        <div class="header">
            <h1>üì∏ My Photo Gallery</h1>
            <p>A beautiful collection of memories</p>
        </div>
        
        <div class="gallery" id="gallery">
            <!-- Gallery items will be generated by JavaScript -->
        </div>
    </div>

    <!-- Modal for full-size image viewing -->
    <div class="modal" id="modal">
        <div class="modal-content">
            <span class="modal-close" onclick="closeModal()">&times;</span>
            <span class="modal-nav modal-prev" onclick="prevImage()">&#10094;</span>
            <img class="modal-img" id="modalImg" src="" alt="Full size image">
            <button class="download-btn" onclick="downloadImage()">‚¨áÔ∏è Download Photo</button>
            <span class="modal-nav modal-next" onclick="nextImage()">&#10095;</span>
            <div class="modal-info" id="modalInfo"></div>
        </div>
    </div>

    <script>
        // Array of all images in the folder
        const images = [
            '1.jpg', '10.jpg', '1000064939jpg.0.jpg', '1000064939jpg.0_(1).jpg', '11.jpg', '12.jpg', '14.jpg', '18.jpg', '2.jpg', '20.jpg',
            '20250902065102865.jpg', '23.jpg', '3.jpg', '36.jpg', '37.jpg', '4.jpg', '5.jpg', '63.jpg', '64.jpg', '66.jpg', '67.jpg',
            '68.jpg', '69.jpg', '7.png', '70.jpg', '78.jpg', '79.jpg', '8.jpg', '80.jpg', '81.jpg', '82.jpg', '83.jpg', '9.jpg',
            'AGC_20250411_103009172.jpg', 'AGC_20250411_120857223.jpg', 'AGC_20250411_120925933.jpg', 'AGC_20250411_121023546.jpg',
            'AGC_20250411_122416883.jpg', 'AGC_20250411_122416883jpg.0.jpg', 'AGC_20250711_061201485.jpg', 'AGC_20250711_061235646.png',
            'farukmirza5467-20251105-0001.jpg', 'farukmirza5467-20251105-0002.jpg', 'farukmirza5467_14040815_084723119.jpg',
            'farukmirza5467_14040815_084732719.jpg', 'farukmirza5467_14040815_084736873.jpg', 'farukmirza5467_14040815_084740332.jpg',
            'farukmirza5467_14040815_084744075.jpg', 'farukmirza5467_14040815_084754249.jpg', 'farukmirza5467_14040815_084757227.jpg',
            'IMG-20250208-WA0001.jpg', 'IMG-20250208-WA0001jpg.0.jpg', 'IMG-20250208-WA0003.jpg', 'IMG-20250208-WA0004.jpg',
            'IMG-20250208-WA0004jpg.0.jpg', 'IMG-20250719-WA0004.jpg', 'IMG-20250719-WA0006.jpg', 'IMG-20251105-WA0002.jpg',
            'IMG20241012170833.jpg', 'IMG20241204122249.jpg', 'IMG20251103142409.jpg', 'IMG20251224124917.jpg', 'IMG20251224124921.jpg',
            'IMG20251224124923.jpg', 'IMG20251224124924.jpg', 'IMG20251224124925.jpg', 'IMG20251224125410.jpg', 'IMG_2024-11-08_151330jpg.0.jpg',
            'IMG_2024-12-23_205820jpg.0.jpg', 'IMG_20250723_134540.jpg', 'IMG_20250723_134627.jpg', 'IMG_20250723_134820.jpg',
            'IMG_20251012_202412_079.webp', 'IMG_20251023_123501_255.jpg', 'IMG_20251023_123504_790.jpg', 'IMG_20251023_123507_687.jpg',
            'IMG_20251023_123515_535.jpg', 'IMG_20251024_142827_946.webp', 'IMG_20251224_130938_050.webp', 'LMC_20250312_2341030.jpg',
            'LMC_20250312_2341140.jpg', 'LMC_20250325_2014490.jpg', 'LMC_20250325_2016390.jpg', 'LMC_20250325_2021380.jpg',
            'LMC_20250325_2220060.jpg', 'LMC_20250329_2151040.PORTRAIT.jpg', 'LMC_20250329_2151040PORTRAITjpg.0.jpg',
            'LMC_20250329_2153250jpg.0_(1).jpg', 'LMC_20250329_2156130.jpg', 'LMC_20250329_2156130jpg.0.jpg',
            'LMC_20250329_2156130jpg.0_(1).jpg', 'LMC_20250329_2201510.jpg', 'LMC_20250329_2201510jpg.0.jpg',
            'LMC_20250329_2201510jpg.0_(1).jpg', 'LMC_20250329_2209340.jpg', 'LMC_20250329_2209340jpg.0.jpg',
            'LMC_20250329_2209340jpg.0_(1).jpg', 'LMC_20250329_2214580.jpg', 'LMC_20250329_2214580jpg.0.jpg',
            'LMC_20250329_2214580jpg.0_(1).jpg', 'LMC_20250329_2219150.jpg', 'LMC_20250329_2219150jpg.0.jpg',
            'LMC_20250329_2219150jpg.0_(1).jpg', 'LMC_20250329_2221420.jpg', 'LMC_20250329_2221420jpg.0.jpg',
            'LMC_20250329_2221420jpg.0_(1).jpg', 'LMC_20250411_0943270.PORTRAIT.jpg', 'LMC_20250411_0943270PORTRAITjpg.0.jpg',
            'RIYAN_20250224_223335_üåµLandscape_By__sofiyanüí´.NIGHT.jpg', 'RIYAN_20250224_223446_üåµLandscape_By__sofiyanüí´.jpg',
            'Screenshot_2025-07-08-21-32-56-42_f9ee0578fe1cc94de7482bd41accb329jpg.0.jpg',
            'Screenshot_2025-07-08-21-32-56-42_f9ee0578fe1cc94de7482bd41accb329jpg.0_(1).jpg',
            'Screenshot_2025-07-25-20-17-49-76_e2d5b3f32b79de1d45acd1fad96fbb0fjpg.0.jpg',
            'Screenshot_2025-07-25-20-17-49-76_e2d5b3f32b79de1d45acd1fad96fbb0fjpg.0_(1).jpg',
            'Screenshot_2025-07-25-20-18-27-59_e2d5b3f32b79de1d45acd1fad96fbb0fjpg.0.jpg',
            'Screenshot_2025-07-25-20-18-27-59_e2d5b3f32b79de1d45acd1fad96fbb0fjpg.0_(1).jpg', 'Snapchat-2118682623.jpg',
            '‰∏Ö·¥á·¥Ñ ú…¥…™·¥Ñ·¥Ä ü  ô·¥Ä Ä…™·¥ã¬≤‚Å¥üáßüá©_20251206_134829_üê≤DSLR SHOTüêâ BY BARIK.MP_1.jpg',
            '‰∏Ö·¥á·¥Ñ ú…¥…™·¥Ñ·¥Ä ü  ô·¥Ä Ä…™·¥ã¬≤‚Å¥üáßüá©_20251206_134830_üê≤DSLR SHOTüêâ BY BARIK.MP_1.jpg',
            '‰∏Ö·¥á·¥Ñ ú…¥…™·¥Ñ·¥Ä ü  ô·¥Ä Ä…™·¥ã¬≤‚Å¥üáßüá©_20251206_134951_üê≤DSLR SHOTüêâ BY BARIK.MP_1.jpg',
            '‰∏Ö·¥á·¥Ñ ú…¥…™·¥Ñ·¥Ä ü  ô·¥Ä Ä…™·¥ã¬≤‚Å¥üáßüá©_20251206_144947_üê≤DSLR SHOTüêâ BY BARIK.MP_1.jpg',
            '‰∏Ö·¥á·¥Ñ ú…¥…™·¥Ñ·¥Ä ü  ô·¥Ä Ä…™·¥ã¬≤‚Å¥üáßüá©_20251206_172538_üê≤DSLR SHOTüêâ BY BARIK.MP_1.jpg',
            '‰∏Ö·¥á·¥Ñ ú…¥…™·¥Ñ·¥Ä ü  ô·¥Ä Ä…™·¥ã¬≤‚Å¥üáßüá©_20251206_172540_üê≤DSLR SHOTüêâ BY BARIK.MP_1.jpg',
            '‰∏Ö·¥á·¥Ñ ú…¥…™·¥Ñ·¥Ä ü  ô·¥Ä Ä…™·¥ã¬≤‚Å¥üáßüá©_20251206_172942_üê≤DSLR SHOTüêâ BY BARIK.MP_1.jpg',
            '‰∏Ö·¥á·¥Ñ ú…¥…™·¥Ñ·¥Ä ü  ô·¥Ä Ä…™·¥ã¬≤‚Å¥üáßüá©_20251206_172944_üê≤DSLR SHOTüêâ BY BARIK.MP_1.jpg',
            '‰∏Ö·¥á·¥Ñ ú…¥…™·¥Ñ·¥Ä ü  ô·¥Ä Ä…™·¥ã¬≤‚Å¥üáßüá©_20251206_172948_üê≤DSLR SHOTüêâ BY BARIK.MP_1.jpg',
            '‰∏Ö·¥á·¥Ñ ú…¥…™·¥Ñ·¥Ä ü  ô·¥Ä Ä…™·¥ã¬≤‚Å¥üáßüá©_20251206_172951_üê≤DSLR SHOTüêâ BY BARIK.MP_1.jpg',
            '‰∏Ö·¥á·¥Ñ ú…¥…™·¥Ñ·¥Ä ü  ô·¥Ä Ä…™·¥ã¬≤‚Å¥üáßüá©_20251206_173042_üê≤DSLR SHOTüêâ BY BARIK.RESTORED_1.jpg',
            '‰∏Ö·¥á·¥Ñ ú…¥…™·¥Ñ·¥Ä ü  ô·¥Ä Ä…™·¥ã¬≤‚Å¥üáßüá©_20251206_173050_üê≤DSLR SHOTüêâ BY BARIK.RESTORED_1.jpg',
            '‰∏Ö·¥á·¥Ñ ú…¥…™·¥Ñ·¥Ä ü  ô·¥Ä Ä…™·¥ã¬≤‚Å¥üáßüá©_20251206_173456_üê≤DSLR SHOTüêâ BY BARIK.MP (1)_1.jpg',
            '‰∏Ö·¥á·¥Ñ ú…¥…™·¥Ñ·¥Ä ü  ô·¥Ä Ä…™·¥ã¬≤‚Å¥üáßüá©_20251206_173456_üê≤DSLR SHOTüêâ BY BARIK.MP_1.jpg',
            '‰∏Ö·¥á·¥Ñ ú…¥…™·¥Ñ·¥Ä ü  ô·¥Ä Ä…™·¥ã¬≤‚Å¥üáßüá©_20251206_173530_üê≤DSLR SHOTüêâ BY BARIK.RESTORED_1.jpg',
            '‰∏Ö·¥á·¥Ñ ú…¥…™·¥Ñ·¥Ä ü  ô·¥Ä Ä…™·¥ã¬≤‚Å¥üáßüá©_20251206_173532_üê≤DSLR SHOTüêâ BY BARIK.RESTORED_1.jpg',
            '‰∏Ö·¥á·¥Ñ ú…¥…™·¥Ñ·¥Ä ü  ô·¥Ä Ä…™·¥ã¬≤‚Å¥üáßüá©_20251206_173955_üê≤DSLR SHOTüêâ BY BARIK.MP_1.jpg',
            '‰∏Ö·¥á·¥Ñ ú…¥…™·¥Ñ·¥Ä ü  ô·¥Ä Ä…™·¥ã¬≤‚Å¥üáßüá©_20251206_173958_üê≤DSLR SHOTüêâ BY BARIK.MP_1.jpg',
            '‰∏Ö·¥á·¥Ñ ú…¥…™·¥Ñ·¥Ä ü  ô·¥Ä Ä…™·¥ã¬≤‚Å¥üáßüá©_20251224_125003_üê≤DSLR SHOTüêâ BY BARIK.PORTRAIT.jpg',
            '‰∏Ö·¥á·¥Ñ ú…¥…™·¥Ñ·¥Ä ü  ô·¥Ä Ä…™·¥ã¬≤‚Å¥üáßüá©_20251224_125004_üê≤DSLR SHOTüêâ BY BARIK.PORTRAIT.jpg',
            '‰∏Ö·¥á·¥Ñ ú…¥…™·¥Ñ·¥Ä ü  ô·¥Ä Ä…™·¥ã¬≤‚Å¥üáßüá©_20251224_125008_üê≤DSLR SHOTüêâ BY BARIK.PORTRAIT.jpg',
            '‰∏Ö·¥á·¥Ñ ú…¥…™·¥Ñ·¥Ä ü_ ô·¥Ä Ä…™·¥ã¬≤‚Å¥üáßüá©_20251104_165627_üê≤DSLR_SHOTüêâ_BY_BARIK.MP.jpg',
            '‰∏Ö·¥á·¥Ñ ú…¥…™·¥Ñ·¥Ä ü_ ô·¥Ä Ä…™·¥ã¬≤‚Å¥üáßüá©_20251104_165631_üê≤DSLR_SHOTüêâ_BY_BARIK.PORTRAIT.jpg',
            '‰∏Ö·¥á·¥Ñ ú…¥…™·¥Ñ·¥Ä ü_ ô·¥Ä Ä…™·¥ã¬≤‚Å¥üáßüá©_20251104_165635_üê≤DSLR_SHOTüêâ_BY_BARIK.PORTRAIT.jpg',
            '‰∏Ö·¥á·¥Ñ ú…¥…™·¥Ñ·¥Ä ü_ ô·¥Ä Ä…™·¥ã¬≤‚Å¥üáßüá©_20251104_165640_üê≤DSLR_SHOTüêâ_BY_BARIK.MP.jpg',
            '‰∏Ö·¥á·¥Ñ ú…¥…™·¥Ñ·¥Ä ü_ ô·¥Ä Ä…™·¥ã¬≤‚Å¥üáßüá©_20251104_165955_üê≤DSLR_SHOTüêâ_BY_BARIK.NIGHT.jpg'
        ];

        let currentImageIndex = 0;
        const imageCache = new Map();
        let loadedCount = 0;
        let totalImages = 0;

        

        function updateLoadingProgress() {
            if (loadedCount === 0 || totalImages === 0) return;
            
            const progress = (loadedCount / totalImages) * 100;
            document.getElementById('loadingBar').style.width = progress + '%';
            
            const counter = document.getElementById('loadingCounter');
            counter.textContent = `üì∏ Loading: ${loadedCount}/${totalImages}`;
            
            if (loadedCount === totalImages) {
                counter.classList.remove('show');
                document.getElementById('loadingBar').style.width = '100%';
                setTimeout(() => {
                    document.getElementById('loadingBar').style.opacity = '0';
                }, 500);
            }
        }

        // Start gallery and hide welcome screen
        function startGallery() {
            const welcomeScreen = document.getElementById('welcomeScreen');
            welcomeScreen.classList.add('hidden');
            setTimeout(() => {
                welcomeScreen.style.display = 'none';
                generateGallery();
            }, 800);
        }

        // Generate gallery items with aggressive lazy loading
        function generateGallery() {
            const gallery = document.getElementById('gallery');
            totalImages = images.length;
            document.getElementById('loadingCounter').classList.add('show');
            
            images.forEach((img, index) => {
                const item = document.createElement('div');
                item.className = 'gallery-item';
                item.style.animationDelay = `${(index % 12) * 0.05}s`;
                item.innerHTML = `
                    <div class="placeholder"></div>
                    <img data-src="my photos/${img}" alt="Gallery image" data-index="${index}">
                    <div class="overlay">
                        <div class="overlay-icon">üîç</div>
                    </div>
                `;
                item.onclick = () => openModal(index);
                gallery.appendChild(item);
            });

            // Setup lazy loading observer with larger preload margin for faster loading
            const imageObserver = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const img = entry.target;
                        const src = img.getAttribute('data-src');
                        const index = img.getAttribute('data-index');
                        
                        // Load image: try to use a smaller thumbnail in thumbs/ first, fallback to full image
                        const baseName = src.split('/').pop().replace(/\.[^.]+$/, '');
                        const thumbUrl = `thumbs/${baseName}.webp`;
                        const actualImg = new Image();
                        actualImg.onload = () => {
                            img.src = thumbUrl;
                            img.setAttribute('loading', 'lazy');
                            img.classList.add('loaded');
                            img.previousElementSibling.style.display = 'none';
                            imageCache.set(index, thumbUrl);
                            loadedCount++;
                            updateLoadingProgress();
                        };
                        actualImg.onerror = () => {
                            // thumb not available, load full image
                            const fallback = new Image();
                            fallback.onload = () => {
                                img.src = src;
                                img.setAttribute('loading', 'lazy');
                                img.classList.add('loaded');
                                img.previousElementSibling.style.display = 'none';
                                imageCache.set(index, src);
                                loadedCount++;
                                updateLoadingProgress();
                            };
                            fallback.onerror = () => {
                                img.previousElementSibling.innerHTML = '‚ùå Failed';
                                loadedCount++;
                                updateLoadingProgress();
                            };
                            fallback.src = src;
                        };
                        // Try thumb first
                        actualImg.src = thumbUrl;
                        observer.unobserve(img);
                    }
                });
            }, { rootMargin: '300px' }); // Increased from 50px for faster preloading

            document.querySelectorAll('[data-src]').forEach(img => {
                imageObserver.observe(img);
            });

            // Start preloading all images in background
                // Preload with concurrency control for faster network utilization
                preloadImages({concurrency: 6});
        }

        // Modal functions
        function openModal(index) {
            currentImageIndex = index;
            const modal = document.getElementById('modal');
            const img = document.getElementById('modalImg');
            const src = `my photos/${images[index]}`;
            
            img.src = src;
            img.onerror = () => nextImage();
            document.getElementById('modalInfo').textContent = `${index + 1} / ${images.length}`;
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeModal() {
            const modal = document.getElementById('modal');
            modal.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        function nextImage() {
            currentImageIndex = (currentImageIndex + 1) % images.length;
            const img = document.getElementById('modalImg');
            const src = `my photos/${images[currentImageIndex]}`;
            img.src = src;
            img.onerror = () => nextImage();
            document.getElementById('modalInfo').textContent = `${currentImageIndex + 1} / ${images.length}`;
        }

        function prevImage() {
            currentImageIndex = (currentImageIndex - 1 + images.length) % images.length;
            const img = document.getElementById('modalImg');
            const src = `my photos/${images[currentImageIndex]}`;
            img.src = src;
            img.onerror = () => prevImage();
            document.getElementById('modalInfo').textContent = `${currentImageIndex + 1} / ${images.length}`;
        }

        function downloadImage() {
            const imgSrc = document.getElementById('modalImg').src;
            const fileName = images[currentImageIndex];
            
            // Create a temporary link element to trigger download
            const link = document.createElement('a');
            link.href = imgSrc;
            link.download = fileName || 'photo.jpg';
            link.style.display = 'none';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            const modal = document.getElementById('modal');
            if (!modal.classList.contains('active')) return;
            
            if (e.key === 'ArrowRight') nextImage();
            if (e.key === 'ArrowLeft') prevImage();
            if (e.key === 'Escape') closeModal();
        });

        // Close modal when clicking outside the image
        document.getElementById('modal').addEventListener('click', (e) => {
            if (e.target.id === 'modal') closeModal();
        });

        // Initialize gallery on page load
        // Don't auto-generate, wait for welcome button
        document.addEventListener('DOMContentLoaded', () => {
            // Attempt to register service worker for caching (improves repeat load times)
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('service-worker.js').catch(() => {});
            }
        });

        // Preload images with a concurrency limit (default 6)
        function preloadImages(options = { concurrency: 6 }) {
            const concurrency = options.concurrency || 6;
            let index = 0;
            const queue = [];

            function next() {
                if (index >= images.length) return Promise.resolve();
                const i = index++;
                const url = `my photos/${images[i]}`;
                return fetch(url, { mode: 'no-cors' })
                    .then(() => {
                        loadedCount++;
                        updateLoadingProgress();
                    })
                    .catch(() => {
                        loadedCount++;
                        updateLoadingProgress();
                    })
                    .then(() => next());
            }

            for (let i = 0; i < concurrency; i++) queue.push(next());
            return Promise.all(queue);
        }
    </script>

</body>
</html>
